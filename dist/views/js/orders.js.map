{"version":3,"sources":["../../../views/js/orders.js"],"names":["fetchOrders","object","get","url","baseURL","beforeSend","authorizeXHR","data","startDate","endDate","success","completionHandler","error","console","log","response","fetchOrder","id","xhr","setRequestHeader","localStorage","token","Orders","props","state","orders","statusFilter","refreshState","bind","showSuccessAlert","result","map","order","date_ordered","Date","setState","iziToast","title","message","timeout","progressBar","loadingState","filteredOrders","Component","OrderHead","OrderTable","rows","OrderRow","date","status","rowClass","format","total_price","OrderTableFooter","totalItems","totalForStatus","length","statusCode","filter","totalUnpaid","totalProcessing","totalShipped","totalCancelled"],"mappings":"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","file":"orders.js","sourcesContent":["import React from 'react';\nimport $ from 'jquery';\nimport moment from 'moment';\n\n// Fetch data\nfunction fetchOrders(object) {\n    $.get({\n        url: `${baseURL}/api/orders/`,\n        beforeSend: authorizeXHR,\n        data: {\n            \"start-date\": object.startDate,\n            \"end-date\": object.endDate\n        },\n        success: object.completionHandler,\n        error: response => console.log(response)\n    });\n}\n\nfunction fetchOrder(id, completionHandler) {\n    $.get({\n        url: `${baseURL}/api/orders/${id}/`,\n        beforeSend: authorizeXHR,\n        success: completionHandler,\n        error: response => console.log(response)\n    });\n}\n\nfunction authorizeXHR(xhr) {\n    xhr.setRequestHeader(\"Authorization\", `Token ${localStorage.token}`);\n}\n\n// React\nclass Orders extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            orders: null,\n            statusFilter: null,\n        };\n\n        this.refreshState = this.refreshState.bind(this);\n        this.refreshState();\n    }\n\n    refreshState(showSuccessAlert = false) {\n        fetchOrders({\n            startDate: \"2017-08-23\",\n            endDate: \"2017-08-30\",\n            completionHandler: result => {\n                //TODO: Sort by date\n\n                const orders = result.map(order => {\n                    order.date_ordered = new Date(order.date_ordered);\n                    return order;\n                });\n\n                this.setState({\n                    orders: orders\n                });\n\n                if (showSuccessAlert) {\n                    iziToast.success({\n                        title: \"Refreshed\",\n                        message: \"Data is up to date.\",\n                        timeout: 1500,\n                        progressBar: false\n                    })\n                }\n            }\n        })\n    }\n\n    static loadingState() {\n        return (\n            <div className=\"container-fluid d-flex flex-column justify-content-center align-items-center h-100\">\n                <h3>Loading...</h3>\n            </div>\n        );\n    }\n\n    render() {\n        if (this.state.orders === null) {\n            return Orders.loadingState();\n        }\n\n        //TODO: Filter\n        const filteredOrders = this.state.orders;\n\n        return (\n            <div id=\"orders\"\n                 className=\"container-fluid m-0 p-0 h-100 w-100 d-flex flex-column\">\n                <OrderHead/>\n                <OrderTable orders={filteredOrders}/>\n            </div>\n        );\n    }\n\n}\n\nclass OrderHead extends React.Component {\n    constructor(props) {\n        super(props);\n    }\n\n    render() {\n        return (\n            <div className=\"container-fluid row ml-auto mr-auto bg-light page-head\">\n                <div className=\"mr-auto row pt-5 pl-3 pr-3\">\n                    <h4 className=\"mr-3\">Orders</h4>\n                    <div>\n                        <button className=\"btn btn-sm btn-outline-primary mr-1\">Refresh Data</button>\n                        <button className=\"btn btn-sm btn-outline-primary\">Generate Report</button>\n                    </div>\n                </div>\n\n                <div className=\"row pt-3 pl-3 mr-3\">\n                    <div className=\"mb-2 mb-sm-0\">\n                        <small className=\"text-muted mt-auto mb-2 mr-3 d-block\">Status filter</small>\n                        <div className=\"btn-group\"\n                             data-toggle=\"buttons\">\n                            <label className=\"btn btn-outline-secondary active\">\n                                <input type=\"radio\"\n                                       autoComplete=\"off\"/>All\n                            </label>\n                            <label className=\"btn btn-outline-secondary\">\n                                <input type=\"radio\"\n                                       autoComplete=\"off\"/>Unpaid\n                            </label>\n                            <label className=\"btn btn-outline-secondary\">\n                                <input type=\"radio\"\n                                       autoComplete=\"off\"/>Verifying Payment\n                            </label>\n                            <label className=\"btn btn-outline-secondary\">\n                                <input type=\"radio\"\n                                       autoComplete=\"off\"/>Processing\n                            </label>\n                            <label className=\"btn btn-outline-secondary\">\n                                <input type=\"radio\"\n                                       autoComplete=\"off\"/>Shipped\n                            </label>\n                            <label className=\"btn btn-outline-secondary\">\n                                <input type=\"radio\"\n                                       name=\"options\"\n                                       autoComplete=\"off\"/>Cancelled\n                            </label>\n                        </div>\n                    </div>\n                    <div className=\"row mb-2 ml-2\">\n                        <div className=\"mr-2\">\n                            <small className=\"text-muted mt-auto mb-2 mr-3 d-block\">Start Date</small>\n                            <div className=\"input-group\">\n                                <input className=\"form-control\"\n                                       type=\"date\"\n                                       placeholder=\"Start Date\"/>\n                            </div>\n                        </div>\n                        <div className=\"mr-2\">\n                            <small className=\"text-muted mt-auto mb-2 mr-3 d-block\">End Date</small>\n                            <div className=\"input-group mb-2 mb-sm-0\">\n\n                                <div className=\"input-group\">\n                                    <input className=\"form-control\"\n                                           type=\"date\"\n                                           placeholder=\"End Date\"/>\n                                </div>\n                            </div>\n                        </div>\n                        <button className=\"btn btn-primary mt-auto\">Filter</button>\n                    </div>\n                </div>\n            </div>\n        )\n    }\n}\n\nclass OrderTable extends React.Component {\n    constructor(props) {\n        super(props);\n        this.rows = this.rows.bind(this);\n    }\n\n    static emptyState() {\n        return (\n            <div>\n                <h1>TODO</h1>\n            </div>\n        )\n    }\n\n    rows() {\n        return this.props.orders.map(order => <OrderRow key={order.id}\n                                                        order={order}/>)\n    }\n\n    render() {\n\n        return (\n            <div className=\"d-flex flex-column page-content\">\n                <table className=\"table table-hover page-table d-flex flex-column\">\n                    <thead className=\"thead-default\">\n                    <tr>\n                        <th>Order Number</th>\n                        <th>Order Total</th>\n                        <th>Order Date</th>\n                        <th>Status</th>\n                    </tr>\n                    </thead>\n                    <tbody>\n                    {this.rows()}\n                    </tbody>\n                </table>\n                <OrderTableFooter orders={this.props.orders}/>\n            </div>\n        )\n    }\n}\n\nclass OrderRow extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.date = this.date.bind(this);\n        this.status = this.status.bind(this);\n        this.rowClass = this.rowClass.bind(this);\n    }\n\n    rowClass() {\n        switch (this.props.order.status) {\n            case 'U':\n                return 'table-light';\n            case 'V':\n                return 'table-warning';\n            case 'P':\n                return 'table-primary';\n            case 'S':\n                return 'table-success';\n            case 'C':\n                return 'table-danger';\n        }\n\n        return '';\n    }\n\n    status() {\n        switch (this.props.order.status) {\n            case 'U':\n                return 'Unpaid';\n            case 'V':\n                return 'Verifying Payment';\n            case 'P':\n                return 'Processing';\n            case 'S':\n                return 'Shipped';\n            case 'C':\n                return 'Cancelled';\n        }\n\n        return this.props.order.status;\n    }\n\n    date() {\n        return moment(this.props.order.date_ordered).format('LLL');\n    }\n\n    render() {\n        return (\n            <tr className={this.rowClass()}>\n                <td>{this.props.order.id}</td>\n                <td>â‚±{this.props.order.total_price}</td>\n                <td>{this.date()}</td>\n                <td>{this.status()}</td>\n            </tr>\n        );\n    }\n}\n\nclass OrderTableFooter extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.totalItems = this.totalItems.bind(this);\n        this.totalForStatus = this.totalForStatus.bind(this);\n    }\n\n    totalItems() {\n        return this.props.orders.length;\n    }\n\n    totalForStatus(statusCode) {\n        return this.props.orders.filter(order => {\n            return order.status === statusCode;\n        }).length;\n    }\n\n    render() {\n        const totalItems = this.totalItems();\n        const totalUnpaid = this.totalForStatus('U');\n        const totalProcessing = this.totalForStatus('P');\n        const totalShipped = this.totalForStatus('S');\n        const totalCancelled = this.totalForStatus('C');\n\n\n        return (\n            <div className=\"table-footer bg-light d-flex align-items-center justify-content-center w-100\">\n                <small className=\"mb-0\">{`${totalItems} Items | ${totalUnpaid} Unpaid | ${totalProcessing} Processing | ${totalShipped} Shipped | ${totalCancelled} Cancelled`}</small>\n            </div>\n        )\n    }\n}\n\nexport default Orders;"]}