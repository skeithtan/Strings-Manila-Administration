{"version":3,"sources":["../../../views/js/modal_submit.js"],"names":["refreshStalls","refreshProducts","$","click","stallNameInput","stallName","val","ajax","url","baseURL","type","data","name","success","iziToast","title","message","error","console","log","response","beforeSend","authorizeXHR","stallID","method","nameInput","priceInput","descriptionInput","imageInput","files","product","price","description","image_link","undefined","length","image","form","FormData","append","post","async","contentType","processData","link","submitAddProduct","warning","xhr","setRequestHeader","localStorage","token"],"mappings":"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","file":"modal_submit.js","sourcesContent":["var refreshStalls;\nvar refreshProducts;\n\n$(() => {\n\n    //MARK: - Entity Management\n    $('#add-stall-button').click(() => {\n        const stallNameInput = $('#add-stall-name-input');\n        const stallName = stallNameInput.val();\n        stallNameInput.val('');\n\n\n        $.ajax({\n            url: baseURL + 'stalls/',\n            type: 'POST',\n            data: {\n                name: stallName\n            },\n            success: () => {\n                iziToast.success({\n                    title: 'Added',\n                    message: 'Successfully added stall.'\n                });\n\n                refreshStalls();\n            },\n            error: response => {\n                console.log(response);\n                iziToast.error({\n                    title: 'Error',\n                    message: 'Unable to add stall.'\n                })\n            },\n            beforeSend: authorizeXHR\n        });\n\n    });\n\n    $('#rename-stall-button').click(() => {\n        const stallNameInput = $('#rename-stall-name-input');\n        const stallName = stallNameInput.val();\n        const stallID = $('#rename-stall-id').val();\n        stallNameInput.val('');\n\n        $.ajax({\n            url: `${baseURL}stalls/${stallID}/`,\n            method: 'PUT',\n            data: {\n                name: stallName\n            },\n            success: () => {\n                iziToast.success({\n                    title: 'Renamed',\n                    message: 'Successfully renamed stall.'\n                });\n\n                refreshStalls();\n            },\n            error: response => {\n                console.log(response);\n                iziToast.error({\n                    title: 'Error',\n                    message: 'Unable to rename stall.'\n                })\n            },\n            beforeSend: authorizeXHR\n        });\n    });\n\n    $('#delete-stall-button').click(() => {\n        const stallID = $('#delete-stall-id').val();\n\n        $.ajax({\n            url: baseURL + 'stalls/' + stallID + '/',\n            method: 'DELETE',\n            success: () => {\n                iziToast.success({\n                    title: 'Deleted',\n                    message: 'Successfully deleted stall.'\n                });\n\n                refreshStalls();\n            },\n            error: response => {\n                console.log(response);\n                iziToast.success({\n                    title: 'Added',\n                    message: 'Could not delete stall.'\n                })\n            },\n            beforeSend: authorizeXHR\n        })\n    });\n\n    $('#add-product-button').click(() => {\n        const nameInput = $('#add-product-name-input');\n        const priceInput = $('#add-product-price-input');\n        const descriptionInput = $('#add-product-description-input');\n        const imageInput = $('#add-product-image-input')[0].files;\n        const stallID = $('#add-product-stall-id').val();\n\n        let product = {\n            name: nameInput.val(),\n            price: priceInput.val(),\n            description: descriptionInput.val(),\n            image_link: undefined\n        };\n\n        if (imageInput.length) {\n            console.log(\"Has image\");\n            const image = imageInput[0];\n            const form = new FormData();\n            form.append('image', image);\n\n            $.post({\n                url: 'https://api.imgur.com/3/image',\n                async: true,\n                data: form,\n                contentType: false,\n                processData: false,\n                success: response => {\n                    product.image = response.data.link;\n                    submitAddProduct(product, stallID)\n                },\n                error: () => {\n                    console.log(\"Upload failed\");\n                    iziToast.warning({\n                        title: 'Error',\n                        message: 'Unable to upload photo. Using default photo instead.'\n                    });\n                    submitAddProduct(product, stallID);\n                },\n                beforeSend: xhr => {\n                    xhr.setRequestHeader('Authorization', 'Client-ID 715b55f24db9cd2')\n                }\n            });\n\n        } else {\n            submitAddProduct(product, stallID);\n        }\n\n        nameInput.val('');\n        priceInput.val('');\n        descriptionInput.val('');\n        imageInput.val('');\n    });\n\n});\n\nfunction submitAddProduct(product, stallID) {\n    $.ajax({\n        url: `${baseURL}stalls/${stallID}/products/`,\n        method: 'POST',\n        data: product,\n        beforeSend: authorizeXHR,\n        success: () => {\n            iziToast.success({\n                title: 'Added',\n                message: 'Successfully added product'\n            })\n        },\n        error: response => {\n            console.log(response);\n            iziToast.error({\n                title: 'Error',\n                message: 'Unable to add product'\n            })\n        }\n    });\n}\n\nfunction authorizeXHR(xhr) {\n    xhr.setRequestHeader(\"Authorization\", \"Token \" + localStorage.token)\n}"]}